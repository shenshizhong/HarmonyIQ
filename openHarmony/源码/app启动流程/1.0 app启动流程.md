
app启动流程
```
base/startup/init/services/init/standard/BUILD.gn
通过 ohos_executable("init") 可执行文件，进到用户态

系统启动完毕，就会进到，etc 下面一堆cfg 文件，包括init.cfg
定义了一堆的job 还有一些service
init 会根据里面的配置，把他们都启动，这样就实现了系统任务的执行

编号为1 的进程 就是init
编号为2 的进程 就是kthreadd


还有一个 592 foundation 进程，在 etc/init 目录下，foundation.cfg
主要就是启动一些系统的基础服务：
比如 ability，window，bundlemanager，graphic

foundation：
jobs 中的cmds 会创建一堆目录，以及一些权限的处理
services 中的 "path" :["/system/bin/sa_main", "/system/profile/foundation.json"]
就是说会执行sa_main 命令，并传参 /system/profile/foundation.json

sa_main 所在目录：
foundation/systemabilitymgr/safwk/services/safwk/BUILD.gn 
ohos_executable("sa_main"){
    sources = ["src/main.cpp"]
}

main.cpp 内部实现：
main(int argc, char *argv[])  这是入口
1、对传入参数的解析，获得 saId。 传入的参数为 /system/profile/foundation.json
2、调用 LocalAbilityManager::GetInstance().SetStartReason(saId) 进行启动

查看 foundation.json，通过 cd /system/profile/    cat foundation.json
foundation.json具体的内容如下：里面包含就是Openharmony 的基础服务
process："foundation"
systemability：[{"libpath": "libbms.z.so"}, {"libpath": "libwms.z.so"}]
每一个花括号内的ability 就是一个服务

libbms.z.so  相当于android 的pms

libappms.z.so
libabilityms.z.so   对Ability的运行及生命周期进行统一的调度和管理

libabilityms.z.so 的由来，是由 ohos_shared_library("abilityms") {sources = abilityms_files }生成的，最下面有地址

abilityms_files 是在 foundation/ability/ability_runtime/services/abilitymgr/abilitymgr.gni 定义的
abilityms_files = [
"src/ability_manager_service.cpp", //ability manager service
] 

libappms.z.so 的由来，是由于 ohos_shared_library("libappms") {sources = ["src/app_spawn_client.cpp"]}  //这里可以猜测，libappms 是appspawn 的客户端

libwms.z.so 的由来， 是由于 ohos_shared_library("libwms") {sources = ["src/window_layout_policy.cpp"]}

总结：所有服务的构建方式都是差不多的，主要是通过 BUILD.gn 生成对应的so，然后再通过sa_main 进行加载解析

```
main.cpp    foundation/systemabilitymgr/safwk/services/safwk/src/main.cpp
ohos_shared_library("abilityms")  foundation/ability/ability_runtime/services/abilitymgr/BUILD.gni
ohos_shared_library("libappms")   foundation/ability/ability_runtime/services/appmgr/BUILD.gn
ohos_shared_library("libwms")   foundation/window/window_manager/wmserver/BUILD.gn
